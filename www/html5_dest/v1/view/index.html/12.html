<!doctype html>
<html >
<head>
    <meta charset="utf-8">
    <title>米多多兼职 </title>
    <meta name="keywords" content="米多多、快速兼职" />
    <meta name="description" content="米多多兼职" />
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta content="telephone=no" name="format-detection" />
    <link rel="stylesheet" href="/v1/css/base.css"/>
    <script type="text/javascript" src="/v1/js_min//third_party/sea.js" ></script>
    <script>
        if (!window.miduoduo) { //如果app没有注入该变量，则认为不在app里
            window.miduoduo = {};
            miduoduo.os  = {};
            miduoduo.os.mddApp = false;
            miduoduo.user = {};
        } else {
            miduoduo.user = JSON.parse(miduoduo.user) ? JSON.parse(miduoduo.user) : {};
            miduoduo.os  = {};
            miduoduo.os.mddApp = true;
        }

        try{
            window.localStorage = LocalStorage;
            miduoduo.user = JSON.parse(window.localStorage.getItem("userInfo")) || miduoduo.user;
            miduoduo.os.mddApp = true;
        }catch(e){
            alert("LocalStorage ERROR : can't find android class LocalStorage. switching to raw localStorage")
        }
        alert("是否在APP中：" + miduoduo.os.mddApp);
        alert("是否有jsbrige对象:" + window.WebViewJavascriptBridge);
        miduoduo.api_baseurl || (miduoduo.api_baseurl = "http://api.test.chongdd.cn/v1/");
        miduoduo.basePath = {
            base : "/v1/",
            picUrl : "/v1/" + "img"
        };
        miduoduo.user.phone = miduoduo.user.username;

       document.addEventListener('WebViewJavascriptBridgeReady', function() {
           WebViewJavascriptBridge.defaultHandler(handle_action)
       }, false);
       function handle_action(data, responseCallback) {
           data = JSON.parse(data);
           if (data && data.action == "b_require_auth") {
               window.localStorage.setItem("userInfo", data.data);
               alert("从登陆页返回，即将reload:" + JSON.stringify(data));
               location.reload();
           }

           var state = true;
           var rst = {
               action: 'q_before_quit',
               result: {
                   value: state,
                   message: ''
               }
           }
           responseCallback(rst);
       };

        seajs.config({
            base: "/v1/js_min/",
            alias: {
                "zepto" : "third_party/zepto.js",
                "zepto-ext" : "widget/zepto-ext.js"
            }
        })
    </script>

<link rel='stylesheet' type='text/css' href='/v1/css/index.css'/>
<script>seajs.use('index')</script>
</head>
<body >
<!--轮播-->
<div id="bannerSlider" class='imageSlide'>
</div>
<!--顶部导航-->
<div class="top-nav">
    <div class="item1" data-url="view/job/all-job.html">
        <img src="/v1/img/index/item1.png" alt=""/>
        <span>最新职位</span>
    </div>
    <div class="item2">
        <img src="/v1/img/index/item2.png" alt=""/>
        <span>暑期工</span>
    </div>
    <div class="item3">
        <img src="/v1/img/index/item3.png" alt=""/>
        <span>日结</span>
    </div>
    <div class="item4">
        <img src="/v1/img/index/item3.png" alt=""/>
        <span>实习</span>
    </div>
</div>

<div class="content">
    <div class="content-bar">

    </div>
    <!--此处插入职位列表模板-->
    <div class="pullUp">加载中...</div>
</div>

<!--banner 轮播模板-->
<script type="text/html" id="banner-slide-tpl">
    <ul>
        <? this.banners.forEach(function(e) {?>
        <li>
            <a href="http://www.baidu.com">
                <img src="<?=e.imgSrc?>" alt=""/>
            </a>
        </li>
        <?});?>
    </ul>
    <div class="num"></div>
</script>
<!--职位列表模板-->
<!--职位列表模板-->
<script type="text/html" id="job-list-tpl">
    <div class="jobList">
        <? var showOthers = this.showOthers;?>
        <? this.jobs.forEach(function(e) { ?>
        <? var task = e.task ? e.task : e;?>
        <a href="view/job/job-detail.html?task=<?=task.id?>">
            <div class="part1">
                <div class="title"><?=task.title?></div>
                <?
                    var ct = new Date(task.created_time);
                    var pubDate = ct.getMonth()+1 + "-" + ct.getDate();
                ?>
                <div class="pub-time"><?=pubDate?></div>
            </div>
            <div class="part2">
                <div class="firstDiv"><?=+task.salary + "/" + (task.salary_unit_label || "?")?></div>
                <? task.labels && task.labels.forEach(function(label, i){?>
                <?if (label) {?>
                <div ><?=label?></div>
                <? } ?>
                <? }); ?>
            </div>
        </a>
        <? if (showOthers) {?>
        <div class="others" data-gid="<?=task.id?>">
            <div class="status"><?=e.status_label?></div>
            <div class="report"> <span style="visibility: hidden">x</span><br/>举报</div>
            <a class="tel" href="tel:<?=task.contact_phonenum?>"><span style="visibility: hidden">x</span><br/>联系企业</a>
        </div>
        <? } ?>
        <? }); ?>
    </div>
</script>
</body>
</html>